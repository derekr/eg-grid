{"version":3,"file":"dev-overlay.min.js","names":[],"sources":["../src/state-machine.ts","../src/engine.ts","../src/plugins/dev-overlay.ts"],"sourcesContent":["/**\n * Centralized State Machine for EG Grid\n *\n * Single source of truth for interaction state.\n *\n * Key invariants:\n * 1. Only ONE interaction can be active at a time (drag OR resize, not both)\n * 2. Column count is captured at interaction start and immutable during interaction\n * 3. Phases: idle → selected → interacting → committing → selected\n */\n\n// ============================================================================\n// State Types\n// ============================================================================\n\nexport type InteractionMode = 'pointer' | 'keyboard';\n\nexport type InteractionType = 'drag' | 'resize';\n\nexport type EggPhase =\n\t| 'idle'\n\t| 'selected'\n\t| 'interacting'  // Active drag or resize\n\t| 'committing';  // Saving to layout model, clearing preview\n\nexport interface InteractionContext {\n\t/** The type of interaction (drag or resize) */\n\ttype: InteractionType;\n\t/** How the interaction was initiated */\n\tmode: InteractionMode;\n\t/** The item being interacted with */\n\titemId: string;\n\t/** The DOM element being interacted with */\n\telement: HTMLElement;\n\t/** Column count at interaction start (immutable during interaction) */\n\tcolumnCount: number;\n}\n\nexport interface EggState {\n\tphase: EggPhase;\n\tselectedItemId: string | null;\n\tinteraction: InteractionContext | null;\n}\n\n// ============================================================================\n// State Machine\n// ============================================================================\n\nexport type StateTransition =\n\t| { type: 'SELECT'; itemId: string; element: HTMLElement }\n\t| { type: 'DESELECT' }\n\t| { type: 'START_INTERACTION'; context: InteractionContext }\n\t| { type: 'COMMIT_INTERACTION' }\n\t| { type: 'CANCEL_INTERACTION' }\n\t| { type: 'FINISH_COMMIT' };\n\nexport interface EggStateMachine {\n\tgetState(): EggState;\n\ttransition(action: StateTransition): EggState;\n}\n\nfunction reducer(state: EggState, action: StateTransition): EggState {\n\tswitch (action.type) {\n\t\tcase 'SELECT': {\n\t\t\tif (state.phase !== 'idle' && state.phase !== 'selected') {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tphase: 'selected',\n\t\t\t\tselectedItemId: action.itemId,\n\t\t\t};\n\t\t}\n\n\t\tcase 'DESELECT': {\n\t\t\tif (state.phase !== 'selected') {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tphase: 'idle',\n\t\t\t\tselectedItemId: null,\n\t\t\t};\n\t\t}\n\n\t\tcase 'START_INTERACTION': {\n\t\t\tif (state.phase !== 'selected') {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tphase: 'interacting',\n\t\t\t\tinteraction: action.context,\n\t\t\t};\n\t\t}\n\n\t\tcase 'COMMIT_INTERACTION': {\n\t\t\tif (state.phase !== 'interacting') {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tphase: 'committing',\n\t\t\t};\n\t\t}\n\n\t\tcase 'CANCEL_INTERACTION': {\n\t\t\tif (state.phase !== 'interacting') {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tphase: 'selected',\n\t\t\t\tinteraction: null,\n\t\t\t};\n\t\t}\n\n\t\tcase 'FINISH_COMMIT': {\n\t\t\tif (state.phase !== 'committing') {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tphase: 'selected',\n\t\t\t\tinteraction: null,\n\t\t\t};\n\t\t}\n\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n\n/**\n * Create a state machine instance\n */\nexport function createStateMachine(): EggStateMachine {\n\tlet state: EggState = {\n\t\tphase: 'idle',\n\t\tselectedItemId: null,\n\t\tinteraction: null,\n\t};\n\n\treturn {\n\t\tgetState() {\n\t\t\treturn state;\n\t\t},\n\n\t\ttransition(action: StateTransition) {\n\t\t\tconst nextState = reducer(state, action);\n\t\t\tif (nextState !== state) {\n\t\t\t\tstate = nextState;\n\t\t\t}\n\t\t\treturn state;\n\t\t},\n\t};\n}\n\nexport function isDragging(state: EggState): boolean {\n\treturn (state.phase === 'interacting' || state.phase === 'committing') && state.interaction?.type === 'drag';\n}\n\nexport function isResizing(state: EggState): boolean {\n\treturn (state.phase === 'interacting' || state.phase === 'committing') && state.interaction?.type === 'resize';\n}\n","import type { GridCell, EggCore, InitOptions, StyleManager } from './types';\nimport { createStateMachine } from './state-machine';\nimport { attachPointer } from './plugins/pointer';\nimport { attachKeyboard } from './plugins/keyboard';\nimport { attachAccessibility } from './plugins/accessibility';\nimport { attachResize } from './plugins/resize';\nimport { attachCamera } from './plugins/camera';\nimport { attachPlaceholder } from './plugins/placeholder';\nimport { attachPushAlgorithm } from './plugins/algorithm-push';\nimport { attachReorderAlgorithm } from './plugins/algorithm-reorder';\nimport { attachResponsive } from './plugins/responsive';\n\n/**\n * Initialize EG Grid on a CSS Grid element\n *\n * @param element - The CSS Grid container element\n * @param options - Configuration options\n */\nexport function init(element: HTMLElement, options: InitOptions = {}): EggCore {\n\tconst {\n\t\tlayoutModel,\n\t\tstyleElement,\n\t} = options;\n\n\tconst cleanups: (() => void)[] = [];\n\n\t// Create centralized state machine\n\tconst stateMachine = createStateMachine();\n\n\t// Track selected element (state machine stores itemId, we need the element)\n\tlet selectedElement: HTMLElement | null = null;\n\n\t// StyleManager: single style element, multiple named layers\n\tconst styleLayers = new Map<string, string>(); // layer name → CSS\n\tconst layerOrder: string[] = []; // insertion order\n\tconst managedStyleElement = styleElement ?? document.createElement('style');\n\tif (!styleElement) {\n\t\tdocument.head.appendChild(managedStyleElement);\n\t\tcleanups.push(() => managedStyleElement.remove());\n\t}\n\n\t// Pre-populate 'base' layer with any existing content (e.g. server-rendered CSS)\n\tconst existingCSS = managedStyleElement.textContent?.trim();\n\tif (existingCSS) {\n\t\tstyleLayers.set('base', existingCSS);\n\t\tlayerOrder.push('base');\n\t}\n\n\tconst styles: StyleManager = {\n\t\tset(layer: string, css: string): void {\n\t\t\tif (!styleLayers.has(layer)) {\n\t\t\t\tlayerOrder.push(layer);\n\t\t\t}\n\t\t\tstyleLayers.set(layer, css);\n\t\t},\n\t\tget(layer: string): string {\n\t\t\treturn styleLayers.get(layer) ?? '';\n\t\t},\n\t\tclear(layer: string): void {\n\t\t\tif (styleLayers.has(layer)) {\n\t\t\t\tstyleLayers.set(layer, '');\n\t\t\t}\n\t\t},\n\t\tcommit(): void {\n\t\t\tconst parts: string[] = [];\n\t\t\tfor (const layer of layerOrder) {\n\t\t\t\tconst css = styleLayers.get(layer);\n\t\t\t\tif (css) parts.push(css);\n\t\t\t}\n\t\t\tmanagedStyleElement.textContent = parts.join('\\n\\n');\n\t\t},\n\t};\n\n\tconst core: EggCore = {\n\t\telement,\n\t\tstateMachine,\n\t\tstyles,\n\t\tcameraScrolling: false,\n\n\t\t// Selection state (backed by state machine)\n\t\tget selectedItem() {\n\t\t\treturn selectedElement;\n\t\t},\n\t\tset selectedItem(item: HTMLElement | null) {\n\t\t\tthis.select(item);\n\t\t},\n\n\t\tselect(item: HTMLElement | null): void {\n\t\t\tif (item === selectedElement) return;\n\n\t\t\tconst previousItem = selectedElement;\n\n\t\t\t// Remove selection from previous item\n\t\t\tif (previousItem) {\n\t\t\t\tpreviousItem.removeAttribute('data-egg-selected');\n\t\t\t}\n\n\t\t\t// Update state machine and local element reference\n\t\t\tif (item) {\n\t\t\t\tconst itemId = item.id || item.getAttribute('data-egg-item') || '';\n\t\t\t\tstateMachine.transition({ type: 'SELECT', itemId, element: item });\n\t\t\t\tselectedElement = item;\n\t\t\t\titem.setAttribute('data-egg-selected', '');\n\t\t\t\tthis.emit('select', { item });\n\t\t\t} else {\n\t\t\t\tstateMachine.transition({ type: 'DESELECT' });\n\t\t\t\tselectedElement = null;\n\t\t\t\tif (previousItem) {\n\t\t\t\t\tthis.emit('deselect', { item: previousItem });\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tdeselect(): void {\n\t\t\tthis.select(null);\n\t\t},\n\n\t\tgetCellFromPoint(x: number, y: number): GridCell | null {\n\t\t\tconst rect = element.getBoundingClientRect();\n\t\t\tif (x < rect.left || x > rect.right || y < rect.top || y > rect.bottom) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst style = getComputedStyle(element);\n\t\t\tconst columns = parseGridTemplate(style.gridTemplateColumns);\n\t\t\tconst rows = parseGridTemplate(style.gridTemplateRows);\n\t\t\tconst columnGap = parseFloat(style.columnGap) || 0;\n\t\t\tconst rowGap = parseFloat(style.rowGap) || 0;\n\n\t\t\tconst relX = x - rect.left + element.scrollLeft;\n\t\t\tconst relY = y - rect.top + element.scrollTop;\n\n\t\t\tconst column = getGridIndex(relX, columns, columnGap);\n\t\t\tconst row = getGridIndex(relY, rows, rowGap);\n\n\t\t\treturn { column, row };\n\t\t},\n\n\t\temit<T>(event: string, detail: T): void {\n\t\t\telement.dispatchEvent(\n\t\t\t\tnew CustomEvent(`egg-${event}`, {\n\t\t\t\t\tbubbles: true,\n\t\t\t\t\tdetail,\n\t\t\t\t}),\n\t\t\t);\n\t\t},\n\n\t\tgetGridInfo() {\n\t\t\tconst rect = element.getBoundingClientRect();\n\t\t\tconst style = getComputedStyle(element);\n\t\t\tconst columns = parseGridTemplate(style.gridTemplateColumns);\n\t\t\tconst rows = parseGridTemplate(style.gridTemplateRows);\n\t\t\tconst columnGap = parseFloat(style.columnGap) || 0;\n\t\t\tconst rowGap = parseFloat(style.rowGap) || 0;\n\n\t\t\treturn {\n\t\t\t\trect,\n\t\t\t\tcolumns,\n\t\t\t\trows,\n\t\t\t\tgap: columnGap, // Assume uniform gap for simplicity\n\t\t\t\tcellWidth: columns[0] || 0,\n\t\t\t\tcellHeight: rows[0] || 0,\n\t\t\t};\n\t\t},\n\n\t\tdestroy(): void {\n\t\t\tcleanups.forEach((cleanup) => cleanup());\n\t\t},\n\t};\n\n\t// Direct initialization — no registry, no loop\n\tif (options.pointer !== false) {\n\t\tcleanups.push(attachPointer(core));\n\t}\n\tif (options.keyboard !== false) {\n\t\tcleanups.push(attachKeyboard(core));\n\t}\n\tif (options.accessibility !== false) {\n\t\tcleanups.push(attachAccessibility(core));\n\t}\n\n\tif (options.resize !== false) {\n\t\tconst resizeOpts = typeof options.resize === 'object' ? options.resize : {};\n\t\tconst inst = attachResize(element, { ...resizeOpts, core });\n\t\tcleanups.push(() => inst.destroy());\n\t}\n\n\tif (options.camera !== false) {\n\t\tconst cameraOpts = typeof options.camera === 'object' ? options.camera : {};\n\t\tconst inst = attachCamera(element, { ...cameraOpts, core });\n\t\tcleanups.push(() => inst.destroy());\n\t}\n\n\tif (options.placeholder !== false) {\n\t\tconst placeholderOpts = typeof options.placeholder === 'object' ? options.placeholder : {};\n\t\tconst inst = attachPlaceholder(element, placeholderOpts);\n\t\tcleanups.push(() => inst.destroy());\n\t}\n\n\t// Algorithm: push (default) or reorder\n\tif (options.algorithm !== false) {\n\t\tconst algoOpts = options.algorithmOptions ?? {};\n\t\tif (options.algorithm === 'reorder') {\n\t\t\tcleanups.push(attachReorderAlgorithm(element, { ...algoOpts, core, layoutModel }));\n\t\t} else {\n\t\t\tcleanups.push(attachPushAlgorithm(element, { ...algoOpts, core, layoutModel }));\n\t\t}\n\t}\n\n\tif (options.responsive) {\n\t\tcleanups.push(attachResponsive(element, options.responsive, core));\n\t}\n\n\treturn core;\n}\n\n/**\n * Parse CSS grid-template-columns/rows into pixel values\n */\nfunction parseGridTemplate(template: string): number[] {\n\t// Handle common cases: px values, fr units resolved to px\n\t// getComputedStyle returns resolved pixel values\n\tconst values = template.split(' ').filter(Boolean);\n\treturn values.map((v) => parseFloat(v) || 0);\n}\n\n/**\n * Get 1-based grid index from pixel position\n * The gap between cells is split at the midpoint - first half belongs to\n * the left/top cell, second half belongs to the right/bottom cell.\n * This makes cell detection symmetric for both directions.\n */\nfunction getGridIndex(pos: number, tracks: number[], gap: number): number {\n\tlet accumulated = 0;\n\tconst halfGap = gap / 2;\n\n\tfor (let i = 0; i < tracks.length; i++) {\n\t\tconst track = tracks[i]!;\n\t\t// Cell boundary extends to the midpoint of the gap\n\t\tconst trackEnd = accumulated + track + halfGap;\n\t\tif (pos <= trackEnd) {\n\t\t\treturn i + 1; // CSS Grid is 1-indexed\n\t\t}\n\t\taccumulated += track + gap;\n\t}\n\n\treturn tracks.length || 1; // Default to last track, or 1 if empty\n}\n\n/**\n * Get the current grid cell of an item\n */\nexport function getItemCell(item: HTMLElement): GridCell {\n\tconst style = getComputedStyle(item);\n\treturn {\n\t\tcolumn: parseInt(style.gridColumnStart, 10) || 1,\n\t\trow: parseInt(style.gridRowStart, 10) || 1,\n\t};\n}\n\n/**\n * Get the size of an item from its data attributes\n */\nexport function getItemSize(item: HTMLElement): { colspan: number; rowspan: number } {\n\treturn {\n\t\tcolspan: parseInt(item.getAttribute('data-egg-colspan') || '1', 10) || 1,\n\t\trowspan: parseInt(item.getAttribute('data-egg-rowspan') || '1', 10) || 1,\n\t};\n}\n\n/**\n * Attach multiple event listeners and return a cleanup function to remove them all\n */\nexport function listenEvents(\n\telement: EventTarget,\n\tevents: Record<string, EventListenerOrEventListenerObject>,\n): () => void {\n\tfor (const [name, handler] of Object.entries(events)) {\n\t\telement.addEventListener(name, handler);\n\t}\n\treturn () => {\n\t\tfor (const [name, handler] of Object.entries(events)) {\n\t\t\telement.removeEventListener(name, handler);\n\t\t}\n\t};\n}\n","/**\n * Development overlay plugin for EG Grid\n *\n * Provides a toggleable panel with:\n * - Debug tab: Grid info, item positions, event log\n * - Config tab: Algorithm options, plugin toggles\n *\n * Toggle with Shift+D (or programmatically)\n */\n\nimport { getItemCell } from '../engine';\nimport { isDragging, isResizing } from '../state-machine';\nimport type { GridInfo, EggCore } from '../types';\n\nexport interface DevOverlayOptions {\n\t/** Initial tab to show ('debug' | 'config') */\n\tinitialTab?: 'debug' | 'config';\n\t/** Keyboard shortcut to toggle (default: 'D' with Shift) */\n\ttoggleKey?: string;\n\t/** Initial visibility */\n\tvisible?: boolean;\n\t/** EggCore instance for provider access */\n\tcore?: EggCore;\n}\n\nexport interface ConfigOption {\n\tkey: string;\n\tlabel: string;\n\ttype: 'boolean' | 'select' | 'action';\n\tvalue?: boolean | string;\n\toptions?: string[]; // For select type\n\tonChange?: (value: boolean | string) => void;\n\tonAction?: () => void; // For action type\n}\n\ninterface EventLogEntry {\n\ttime: number;\n\ttype: string;\n\tdetail: string;\n}\n\nconst STYLES = `\n.egg-dev-overlay {\n\tposition: fixed;\n\tbottom: 16px;\n\tright: 16px;\n\twidth: 320px;\n\tmax-height: 400px;\n\tbackground: rgba(0, 0, 0, 0.95);\n\tcolor: #fff;\n\tfont-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;\n\tfont-size: 12px;\n\tborder-radius: 8px;\n\tbox-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);\n\tz-index: 1000;\n\tdisplay: flex;\n\tflex-direction: column;\n\toverflow: hidden;\n\tview-transition-name: dev-overlay;\n}\n\n.egg-dev-overlay[hidden] {\n\tdisplay: none;\n}\n\n.egg-dev-tabs {\n\tdisplay: flex;\n\tborder-bottom: 1px solid #333;\n\tflex-shrink: 0;\n}\n\n.egg-dev-tab {\n\tflex: 1;\n\tpadding: 8px 12px;\n\tbackground: transparent;\n\tborder: none;\n\tcolor: #888;\n\tcursor: pointer;\n\tfont-family: inherit;\n\tfont-size: 11px;\n\ttext-transform: uppercase;\n\tletter-spacing: 0.5px;\n}\n\n.egg-dev-tab:hover {\n\tcolor: #ccc;\n}\n\n.egg-dev-tab[data-active=\"true\"] {\n\tcolor: #fff;\n\tbackground: #222;\n}\n\n.egg-dev-content {\n\tflex: 1;\n\toverflow-y: auto;\n\tpadding: 12px;\n}\n\n.egg-dev-section {\n\tmargin-bottom: 12px;\n}\n\n.egg-dev-section:last-child {\n\tmargin-bottom: 0;\n}\n\n.egg-dev-section-title {\n\tcolor: #888;\n\tfont-size: 10px;\n\ttext-transform: uppercase;\n\tletter-spacing: 0.5px;\n\tmargin-bottom: 6px;\n}\n\n.egg-dev-grid-info {\n\tdisplay: grid;\n\tgrid-template-columns: 1fr 1fr;\n\tgap: 4px;\n}\n\n.egg-dev-info-item {\n\tdisplay: flex;\n\tjustify-content: space-between;\n}\n\n.egg-dev-info-label {\n\tcolor: #888;\n}\n\n.egg-dev-info-value {\n\tcolor: #4ade80;\n}\n\n.egg-dev-items-list {\n\tmax-height: 120px;\n\toverflow-y: auto;\n}\n\n.egg-dev-item-row {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tpadding: 2px 0;\n\tborder-bottom: 1px solid #222;\n}\n\n.egg-dev-item-id {\n\tcolor: #60a5fa;\n}\n\n.egg-dev-item-pos {\n\tcolor: #888;\n}\n\n.egg-dev-event-log {\n\tmax-height: 150px;\n\toverflow-y: auto;\n}\n\n.egg-dev-event {\n\tpadding: 2px 0;\n\tborder-bottom: 1px solid #222;\n\tdisplay: flex;\n\tgap: 8px;\n}\n\n.egg-dev-event-time {\n\tcolor: #666;\n\tflex-shrink: 0;\n}\n\n.egg-dev-event-type {\n\tcolor: #f472b6;\n\tflex-shrink: 0;\n}\n\n.egg-dev-event-detail {\n\tcolor: #888;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\twhite-space: nowrap;\n}\n\n.egg-dev-config-row {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tpadding: 6px 0;\n\tborder-bottom: 1px solid #222;\n}\n\n.egg-dev-config-label {\n\tcolor: #ccc;\n}\n\n.egg-dev-toggle {\n\tposition: relative;\n\twidth: 36px;\n\theight: 20px;\n\tbackground: #444;\n\tborder-radius: 10px;\n\tcursor: pointer;\n\ttransition: background 0.2s;\n}\n\n.egg-dev-toggle[data-checked=\"true\"] {\n\tbackground: #4ade80;\n}\n\n.egg-dev-toggle::after {\n\tcontent: '';\n\tposition: absolute;\n\ttop: 2px;\n\tleft: 2px;\n\twidth: 16px;\n\theight: 16px;\n\tbackground: #fff;\n\tborder-radius: 50%;\n\ttransition: transform 0.2s;\n}\n\n.egg-dev-toggle[data-checked=\"true\"]::after {\n\ttransform: translateX(16px);\n}\n\n.egg-dev-select {\n\tbackground: #333;\n\tcolor: #fff;\n\tborder: 1px solid #444;\n\tborder-radius: 4px;\n\tpadding: 4px 8px;\n\tfont-family: inherit;\n\tfont-size: 12px;\n}\n\n.egg-dev-close {\n\tposition: absolute;\n\ttop: 8px;\n\tright: 8px;\n\tbackground: transparent;\n\tborder: none;\n\tcolor: #666;\n\tcursor: pointer;\n\tfont-size: 16px;\n\tline-height: 1;\n\tpadding: 4px;\n}\n\n.egg-dev-close:hover {\n\tcolor: #fff;\n}\n\n.egg-dev-hint {\n\tcolor: #666;\n\tfont-size: 10px;\n\ttext-align: center;\n\tpadding: 8px;\n\tborder-top: 1px solid #222;\n}\n\n.egg-dev-action-btn {\n\tbackground: #333;\n\tcolor: #fff;\n\tborder: 1px solid #444;\n\tborder-radius: 4px;\n\tpadding: 6px 12px;\n\tfont-family: inherit;\n\tfont-size: 12px;\n\tcursor: pointer;\n\ttransition: background 0.2s;\n}\n\n.egg-dev-action-btn:hover {\n\tbackground: #444;\n}\n\n.egg-dev-action-btn:active {\n\tbackground: #555;\n}\n\n.egg-dev-status {\n\tcolor: #888;\n\tfont-size: 11px;\n\tmargin-top: 4px;\n}\n`;\n\n/**\n * Attach the dev overlay to a grid element\n */\nexport function attachDevOverlay(\n\tgridElement: HTMLElement,\n\toptions: DevOverlayOptions = {},\n): { toggle: () => void; show: () => void; hide: () => void; registerOption: (option: ConfigOption) => void; destroy: () => void } {\n\tconst { initialTab = 'debug', toggleKey = 'D', visible = false, core } = options;\n\n\t// Inject styles\n\tlet styleElement = document.getElementById('egg-dev-overlay-styles') as HTMLStyleElement | null;\n\tif (!styleElement) {\n\t\tstyleElement = document.createElement('style');\n\t\tstyleElement.id = 'egg-dev-overlay-styles';\n\t\tstyleElement.textContent = STYLES;\n\t\tdocument.head.appendChild(styleElement);\n\t}\n\n\t// State\n\tlet currentTab = initialTab;\n\tlet isVisible = visible;\n\tconst eventLog: EventLogEntry[] = [];\n\tconst configOptions: ConfigOption[] = [];\n\tconst startTime = performance.now();\n\n\t// Create overlay element\n\tconst overlay = document.createElement('div');\n\toverlay.className = 'egg-dev-overlay';\n\toverlay.hidden = !isVisible;\n\n\tfunction formatTime(time: number): string {\n\t\tconst elapsed = ((time - startTime) / 1000).toFixed(1);\n\t\treturn `${elapsed}s`;\n\t}\n\n\tfunction render() {\n\t\tconst gridInfo = core?.getGridInfo();\n\t\tconst items = Array.from(gridElement.querySelectorAll('[data-egg-item]')) as HTMLElement[];\n\n\t\toverlay.innerHTML = `\n\t\t\t<button class=\"egg-dev-close\">&times;</button>\n\t\t\t<div class=\"egg-dev-tabs\">\n\t\t\t\t<button class=\"egg-dev-tab\" data-tab=\"debug\" data-active=\"${currentTab === 'debug'}\">Debug</button>\n\t\t\t\t<button class=\"egg-dev-tab\" data-tab=\"config\" data-active=\"${currentTab === 'config'}\">Config</button>\n\t\t\t</div>\n\t\t\t<div class=\"egg-dev-content\">\n\t\t\t\t${currentTab === 'debug' ? renderDebugTab(gridInfo, items) : renderConfigTab()}\n\t\t\t</div>\n\t\t\t<div class=\"egg-dev-hint\">Shift+${toggleKey} to toggle</div>\n\t\t`;\n\n\t\t// Attach event listeners\n\t\toverlay.querySelector('.egg-dev-close')?.addEventListener('click', hide);\n\n\t\toverlay.querySelectorAll('.egg-dev-tab').forEach(tab => {\n\t\t\ttab.addEventListener('click', () => {\n\t\t\t\tcurrentTab = (tab as HTMLElement).dataset.tab as 'debug' | 'config';\n\t\t\t\trender();\n\t\t\t});\n\t\t});\n\n\t\t// Config toggles\n\t\toverlay.querySelectorAll('.egg-dev-toggle').forEach(toggle => {\n\t\t\ttoggle.addEventListener('click', () => {\n\t\t\t\tconst key = (toggle as HTMLElement).dataset.key;\n\t\t\t\tconst option = configOptions.find(o => o.key === key);\n\t\t\t\tif (option && option.type === 'boolean') {\n\t\t\t\t\toption.value = !option.value;\n\t\t\t\t\toption.onChange(option.value);\n\t\t\t\t\trender();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// Config selects\n\t\toverlay.querySelectorAll('.egg-dev-select').forEach(select => {\n\t\t\tselect.addEventListener('change', (e) => {\n\t\t\t\tconst key = (select as HTMLElement).dataset.key;\n\t\t\t\tconst option = configOptions.find(o => o.key === key);\n\t\t\t\tif (option && option.type === 'select' && option.onChange) {\n\t\t\t\t\toption.value = (e.target as HTMLSelectElement).value;\n\t\t\t\t\toption.onChange(option.value);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// Action buttons\n\t\toverlay.querySelectorAll('.egg-dev-action-btn').forEach(btn => {\n\t\t\tbtn.addEventListener('click', () => {\n\t\t\t\tconst key = (btn as HTMLElement).dataset.key;\n\t\t\t\tconst option = configOptions.find(o => o.key === key);\n\t\t\t\tif (option && option.type === 'action' && option.onAction) {\n\t\t\t\t\toption.onAction();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tfunction renderDebugTab(gridInfo: GridInfo | undefined, items: HTMLElement[]): string {\n\t\tif (!gridInfo) return '<div class=\"egg-dev-section\">No core available</div>';\n\t\t// Query state machine for live state\n\t\tconst smState = core?.stateMachine.getState();\n\t\tconst dragging = smState && isDragging(smState);\n\t\tconst resizing = smState && isResizing(smState);\n\t\tconst interaction = smState?.interaction;\n\n\t\treturn `\n\t\t\t${core ? `\n\t\t\t<div class=\"egg-dev-section\">\n\t\t\t\t<div class=\"egg-dev-section-title\">State</div>\n\t\t\t\t<div class=\"egg-dev-grid-info\">\n\t\t\t\t\t<div class=\"egg-dev-info-item\">\n\t\t\t\t\t\t<span class=\"egg-dev-info-label\">phase</span>\n\t\t\t\t\t\t<span class=\"egg-dev-info-value\">${smState?.phase ?? 'unknown'}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"egg-dev-info-item\">\n\t\t\t\t\t\t<span class=\"egg-dev-info-label\">interaction</span>\n\t\t\t\t\t\t<span class=\"egg-dev-info-value\">${dragging ? 'dragging' : resizing ? 'resizing' : 'none'}${interaction ? ` (${interaction.mode})` : ''}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t${interaction ? `\n\t\t\t\t\t<div class=\"egg-dev-info-item\">\n\t\t\t\t\t\t<span class=\"egg-dev-info-label\">item</span>\n\t\t\t\t\t\t<span class=\"egg-dev-info-value\">${interaction.itemId || '?'}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t` : ''}\n\t\t\t\t\t<div class=\"egg-dev-info-item\">\n\t\t\t\t\t\t<span class=\"egg-dev-info-label\">selected</span>\n\t\t\t\t\t\t<span class=\"egg-dev-info-value\">${smState?.selectedItemId ?? 'none'}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t` : ''}\n\t\t\t<div class=\"egg-dev-section\">\n\t\t\t\t<div class=\"egg-dev-section-title\">Grid Info</div>\n\t\t\t\t<div class=\"egg-dev-grid-info\">\n\t\t\t\t\t<div class=\"egg-dev-info-item\">\n\t\t\t\t\t\t<span class=\"egg-dev-info-label\">Columns</span>\n\t\t\t\t\t\t<span class=\"egg-dev-info-value\">${gridInfo.columns.length}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"egg-dev-info-item\">\n\t\t\t\t\t\t<span class=\"egg-dev-info-label\">Rows</span>\n\t\t\t\t\t\t<span class=\"egg-dev-info-value\">${gridInfo.rows.length}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"egg-dev-info-item\">\n\t\t\t\t\t\t<span class=\"egg-dev-info-label\">Cell W</span>\n\t\t\t\t\t\t<span class=\"egg-dev-info-value\">${Math.round(gridInfo.cellWidth)}px</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"egg-dev-info-item\">\n\t\t\t\t\t\t<span class=\"egg-dev-info-label\">Cell H</span>\n\t\t\t\t\t\t<span class=\"egg-dev-info-value\">${Math.round(gridInfo.cellHeight)}px</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"egg-dev-info-item\">\n\t\t\t\t\t\t<span class=\"egg-dev-info-label\">Gap</span>\n\t\t\t\t\t\t<span class=\"egg-dev-info-value\">${gridInfo.gap}px</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"egg-dev-info-item\">\n\t\t\t\t\t\t<span class=\"egg-dev-info-label\">Items</span>\n\t\t\t\t\t\t<span class=\"egg-dev-info-value\">${items.length}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"egg-dev-section\">\n\t\t\t\t<div class=\"egg-dev-section-title\">Items</div>\n\t\t\t\t<div class=\"egg-dev-items-list\">\n\t\t\t\t\t${items.map(item => {\n\t\t\t\t\t\tconst cell = getItemCell(item);\n\t\t\t\t\t\tconst id = item.dataset.eggItem || item.dataset.id || item.id || '?';\n\t\t\t\t\t\tconst colspan = item.getAttribute('data-egg-colspan') || '1';\n\t\t\t\t\t\tconst rowspan = item.getAttribute('data-egg-rowspan') || '1';\n\t\t\t\t\t\treturn `\n\t\t\t\t\t\t\t<div class=\"egg-dev-item-row\">\n\t\t\t\t\t\t\t\t<span class=\"egg-dev-item-id\">${id}</span>\n\t\t\t\t\t\t\t\t<span class=\"egg-dev-item-pos\">col ${cell.column}, row ${cell.row} (${colspan}×${rowspan})</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`;\n\t\t\t\t\t}).join('')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"egg-dev-section\">\n\t\t\t\t<div class=\"egg-dev-section-title\">Event Log</div>\n\t\t\t\t<div class=\"egg-dev-event-log\">\n\t\t\t\t\t${eventLog.length === 0 ? '<div style=\"color: #666\">No events yet</div>' : ''}\n\t\t\t\t\t${eventLog.slice(-20).reverse().map(entry => `\n\t\t\t\t\t\t<div class=\"egg-dev-event\">\n\t\t\t\t\t\t\t<span class=\"egg-dev-event-time\">${formatTime(entry.time)}</span>\n\t\t\t\t\t\t\t<span class=\"egg-dev-event-type\">${entry.type}</span>\n\t\t\t\t\t\t\t<span class=\"egg-dev-event-detail\">${entry.detail}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`).join('')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tfunction renderConfigTab(): string {\n\t\tif (configOptions.length === 0) {\n\t\t\treturn `<div style=\"color: #666; text-align: center; padding: 20px;\">No config options registered.<br><br>Use registerOption() to add options.</div>`;\n\t\t}\n\n\t\tconst toggles = configOptions.filter(o => o.type === 'boolean');\n\t\tconst selects = configOptions.filter(o => o.type === 'select');\n\t\tconst actions = configOptions.filter(o => o.type === 'action');\n\n\t\treturn `\n\t\t\t<div class=\"egg-dev-section\">\n\t\t\t\t<div class=\"egg-dev-section-title\">Options</div>\n\t\t\t\t${toggles.map(option => `\n\t\t\t\t\t<div class=\"egg-dev-config-row\">\n\t\t\t\t\t\t<span class=\"egg-dev-config-label\">${option.label}</span>\n\t\t\t\t\t\t<div class=\"egg-dev-toggle\" data-key=\"${option.key}\" data-checked=\"${option.value}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`).join('')}\n\t\t\t\t${selects.map(option => `\n\t\t\t\t\t<div class=\"egg-dev-config-row\">\n\t\t\t\t\t\t<span class=\"egg-dev-config-label\">${option.label}</span>\n\t\t\t\t\t\t<select class=\"egg-dev-select\" data-key=\"${option.key}\">\n\t\t\t\t\t\t\t${(option.options || []).map(opt => `<option value=\"${opt}\"${opt === option.value ? ' selected' : ''}>${opt}</option>`).join('')}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t`).join('')}\n\t\t\t</div>\n\t\t\t${actions.length > 0 ? `\n\t\t\t\t<div class=\"egg-dev-section\">\n\t\t\t\t\t<div class=\"egg-dev-section-title\">Actions</div>\n\t\t\t\t\t${actions.map(option => `\n\t\t\t\t\t\t<div class=\"egg-dev-config-row\">\n\t\t\t\t\t\t\t<span class=\"egg-dev-config-label\">${option.label}</span>\n\t\t\t\t\t\t\t<button class=\"egg-dev-action-btn\" data-key=\"${option.key}\">Run</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`).join('')}\n\t\t\t\t</div>\n\t\t\t` : ''}\n\t\t`;\n\t}\n\n\tfunction logEvent(type: string, detail: string) {\n\t\teventLog.push({ time: performance.now(), type, detail });\n\t\tif (eventLog.length > 100) {\n\t\t\teventLog.shift();\n\t\t}\n\t\tif (isVisible && currentTab === 'debug') {\n\t\t\trender();\n\t\t}\n\t}\n\n\tfunction show() {\n\t\tisVisible = true;\n\t\toverlay.hidden = false;\n\t\trender();\n\t}\n\n\tfunction hide() {\n\t\tisVisible = false;\n\t\toverlay.hidden = true;\n\t}\n\n\tfunction toggle() {\n\t\tif (isVisible) {\n\t\t\thide();\n\t\t} else {\n\t\t\tshow();\n\t\t}\n\t}\n\n\tfunction registerOption(option: ConfigOption) {\n\t\tconst existing = configOptions.findIndex(o => o.key === option.key);\n\t\tif (existing >= 0) {\n\t\t\tconfigOptions[existing] = option;\n\t\t} else {\n\t\t\tconfigOptions.push(option);\n\t\t}\n\t\tif (isVisible) {\n\t\t\trender();\n\t\t}\n\t}\n\n\t// Event listeners for logging\n\tconst onDragStart = (e: Event) => {\n\t\tconst detail = (e as CustomEvent).detail;\n\t\tconst id = detail.item?.dataset?.eggItem || detail.item?.dataset?.id || detail.item?.id || '?';\n\t\tlogEvent('drag-start', `${id} at (${detail.cell.column}, ${detail.cell.row})`);\n\t};\n\n\tconst onDragMove = (e: Event) => {\n\t\tconst detail = (e as CustomEvent).detail;\n\t\tconst id = detail.item?.dataset?.eggItem || detail.item?.dataset?.id || detail.item?.id || '?';\n\t\tlogEvent('drag-move', `${id} → (${detail.cell.column}, ${detail.cell.row})`);\n\t};\n\n\tconst onDragEnd = (e: Event) => {\n\t\tconst detail = (e as CustomEvent).detail;\n\t\tconst id = detail.item?.dataset?.eggItem || detail.item?.dataset?.id || detail.item?.id || '?';\n\t\tlogEvent('drag-end', `${id} at (${detail.cell.column}, ${detail.cell.row})`);\n\t};\n\n\tconst onDragCancel = (e: Event) => {\n\t\tconst detail = (e as CustomEvent).detail;\n\t\tconst id = detail.item?.dataset?.eggItem || detail.item?.dataset?.id || detail.item?.id || '?';\n\t\tlogEvent('drag-cancel', id);\n\t};\n\n\tconst onSelect = (e: Event) => {\n\t\tconst detail = (e as CustomEvent).detail;\n\t\tconst id = detail.item?.dataset?.eggItem || detail.item?.dataset?.id || detail.item?.id || '?';\n\t\tlogEvent('select', id);\n\t};\n\n\tconst onDeselect = (e: Event) => {\n\t\tconst detail = (e as CustomEvent).detail;\n\t\tconst id = detail.item?.dataset?.eggItem || detail.item?.dataset?.id || detail.item?.id || 'none';\n\t\tlogEvent('deselect', id);\n\t};\n\n\tconst onKeyDown = (e: KeyboardEvent) => {\n\t\tif (e.key === toggleKey && e.shiftKey && !e.ctrlKey && !e.altKey && !e.metaKey) {\n\t\t\te.preventDefault();\n\t\t\ttoggle();\n\t\t}\n\t};\n\n\t// Attach listeners\n\tgridElement.addEventListener('egg-drag-start', onDragStart);\n\tgridElement.addEventListener('egg-drag-move', onDragMove);\n\tgridElement.addEventListener('egg-drag-end', onDragEnd);\n\tgridElement.addEventListener('egg-drag-cancel', onDragCancel);\n\tgridElement.addEventListener('egg-select', onSelect);\n\tgridElement.addEventListener('egg-deselect', onDeselect);\n\tdocument.addEventListener('keydown', onKeyDown);\n\n\t// Add to DOM\n\tdocument.body.appendChild(overlay);\n\trender();\n\n\tfunction destroy() {\n\t\tgridElement.removeEventListener('egg-drag-start', onDragStart);\n\t\tgridElement.removeEventListener('egg-drag-move', onDragMove);\n\t\tgridElement.removeEventListener('egg-drag-end', onDragEnd);\n\t\tgridElement.removeEventListener('egg-drag-cancel', onDragCancel);\n\t\tgridElement.removeEventListener('egg-select', onSelect);\n\t\tgridElement.removeEventListener('egg-deselect', onDeselect);\n\t\tdocument.removeEventListener('keydown', onKeyDown);\n\t\toverlay.remove();\n\t}\n\n\treturn { toggle, show, hide, registerOption, destroy };\n}\n"],"mappings":"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"}