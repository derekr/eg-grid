function e(e){return{colspan:parseInt(e.getAttribute(`data-egg-colspan`)||`1`,10)||1,rowspan:parseInt(e.getAttribute(`data-egg-rowspan`)||`1`,10)||1}}function t(e,t,n,r){let i=t.getBoundingClientRect(),a=e.clientX-i.left,o=e.clientY-i.top,s=a<n,c=a>i.width-n,l=o<n,u=o>i.height-n;if(r===`corners`||r===`all`){if(l&&s)return`nw`;if(l&&c)return`ne`;if(u&&s)return`sw`;if(u&&c)return`se`}if(r===`edges`||r===`all`){if(l)return`n`;if(u)return`s`;if(s)return`w`;if(c)return`e`}return null}var n={nw:`nwse-resize`,se:`nwse-resize`,ne:`nesw-resize`,sw:`nesw-resize`,n:`ns-resize`,s:`ns-resize`,e:`ew-resize`,w:`ew-resize`};function r(){let e=document.createElement(`div`);return e.className=`egg-resize-label`,e.style.cssText=`
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		background: rgba(0, 0, 0, 0.8);
		color: white;
		padding: 4px 8px;
		border-radius: 4px;
		font-size: 14px;
		font-weight: 600;
		font-family: system-ui, sans-serif;
		pointer-events: none;
		z-index: 1000;
		white-space: nowrap;
	`,e}function i(i,a){let{core:o,handles:s=`corners`,handleSize:c=12,minSize:l={colspan:1,rowspan:1},maxSize:u={colspan:6,rowspan:6},showSizeLabel:d=!0}=a,f=null,p=null,m=null;function h(e,t){i.dispatchEvent(new CustomEvent(`egg-${e}`,{bubbles:!0,detail:t}))}function g(t,n,i){let{colspan:a,rowspan:s}=e(t),c=getComputedStyle(t),l=parseInt(c.gridColumnStart,10)||1,u=parseInt(c.gridRowStart,10)||1,p={colspan:a,rowspan:s},m={column:l,row:u},g=t.getBoundingClientRect(),_=null;d&&(_=r(),_.textContent=`${a}×${s}`,t.appendChild(_)),f={item:t,pointerId:i.pointerId,handle:n,startCell:m,originalSize:p,currentCell:{...m},currentSize:{...p},sizeLabel:_,initialRect:g,startPointerX:i.clientX,startPointerY:i.clientY},t.setAttribute(`data-egg-resizing`,``),t.setAttribute(`data-egg-handle-active`,n),t.removeAttribute(`data-egg-handle-hover`),t.setPointerCapture(i.pointerId),t.addEventListener(`pointermove`,C),t.addEventListener(`pointerup`,w),t.addEventListener(`pointercancel`,T);let v=t.id||t.getAttribute(`data-egg-item`)||``;o.stateMachine.transition({type:`START_INTERACTION`,context:{type:`resize`,mode:`pointer`,itemId:v,element:t,columnCount:o.getGridInfo().columns.length}}),h(`resize-start`,{item:t,cell:m,colspan:p.colspan,rowspan:p.rowspan,handle:n,source:`pointer`}),t.style.position=`fixed`,t.style.left=`${g.left}px`,t.style.top=`${g.top}px`,t.style.width=`${g.width}px`,t.style.height=`${g.height}px`,t.style.zIndex=`100`,t.style.viewTransitionName=`resizing`}function _(e){if(!f)return;let{item:t,handle:n,startCell:r,originalSize:i,currentCell:a,currentSize:s,sizeLabel:c,initialRect:d,startPointerX:p,startPointerY:m}=f,g=o.getGridInfo(),_=e.clientX-p,v=e.clientY-m,y=d.width,b=d.height,x=d.left,S=d.top,C=g.cellWidth,w=g.cellHeight,T=u.colspan*g.cellWidth+(u.colspan-1)*g.gap,E=u.rowspan*g.cellHeight+(u.rowspan-1)*g.gap,D=g.rect.right-d.left,O=g.rect.bottom-d.top,k=Math.min(T,D),A=Math.min(E,O);if((n===`e`||n===`se`||n===`ne`)&&(y=Math.max(C,Math.min(k,d.width+_))),n===`w`||n===`sw`||n===`nw`){let e=d.left-g.rect.left,t=Math.min(T,d.width+e),n=Math.max(-d.width+C,Math.min(t-d.width,-_));y=d.width+n,x=d.left-n}if((n===`s`||n===`se`||n===`sw`)&&(b=Math.max(w,Math.min(A,d.height+v))),n===`n`||n===`ne`||n===`nw`){let e=d.top-g.rect.top,t=Math.min(E,d.height+e),n=Math.max(-d.height+w,Math.min(t-d.height,-v));b=d.height+n,S=d.top-n}t.style.left=`${x}px`,t.style.top=`${S}px`,t.style.width=`${y}px`,t.style.height=`${b}px`;let j=g.cellWidth+g.gap,M=g.cellHeight+g.gap,N=(y+g.gap)/j,P=(b+g.gap)/M,F=.3,I=Math.floor(N+(1-F)),L=Math.floor(P+(1-F));I=Math.max(l.colspan,Math.min(u.colspan,I)),L=Math.max(l.rowspan,Math.min(u.rowspan,L));let R=r.column,z=r.row;(n===`w`||n===`sw`||n===`nw`)&&(R=r.column+i.colspan-1-I+1),(n===`n`||n===`ne`||n===`nw`)&&(z=r.row+i.rowspan-1-L+1),f.currentSize={colspan:I,rowspan:L},f.currentCell={column:R,row:z},c&&(c.textContent=`${I}×${L}`);let B;B=n===`se`||n===`s`||n===`e`?{column:r.column,row:r.row}:n===`nw`||n===`n`||n===`w`?{column:r.column+i.colspan-1,row:r.row+i.rowspan-1}:n===`ne`?{column:r.column,row:r.row+i.rowspan-1}:{column:r.column+i.colspan-1,row:r.row},h(`resize-move`,{item:t,cell:{column:R,row:z},anchorCell:B,startCell:r,colspan:I,rowspan:L,handle:n,source:`pointer`})}function v(e,t){e.releasePointerCapture(t),e.removeEventListener(`pointermove`,C),e.removeEventListener(`pointerup`,w),e.removeEventListener(`pointercancel`,T)}function y(e,t,n){v(e,t),n&&n.remove(),e.style.position=``,e.style.left=``,e.style.top=``,e.style.width=``,e.style.height=``,e.style.zIndex=``;let r=e.style.getPropertyValue(`--item-id`)||e.dataset.eggItem||e.id||e.dataset.id;e.style.viewTransitionName=r||``,e.removeAttribute(`data-egg-resizing`),e.removeAttribute(`data-egg-handle-active`)}function b(){if(!f)return;let{item:e,pointerId:t,currentSize:n,currentCell:r,sizeLabel:i}=f;e.setAttribute(`data-egg-colspan`,String(n.colspan)),e.setAttribute(`data-egg-rowspan`,String(n.rowspan)),o.stateMachine.transition({type:`COMMIT_INTERACTION`}),h(`resize-end`,{item:e,cell:r,colspan:n.colspan,rowspan:n.rowspan,source:`pointer`}),y(e,t,i),f=null,o.stateMachine.transition({type:`FINISH_COMMIT`})}function x(){if(!f)return;let{item:e,pointerId:t,sizeLabel:n}=f;h(`resize-cancel`,{item:e,source:`pointer`}),o.stateMachine.transition({type:`CANCEL_INTERACTION`}),y(e,t,n),f=null}let S=e=>{let n=e.target.closest(`[data-egg-item]`);if(!n)return;let r=t(e,n,c,s);r&&(e.stopPropagation(),e.preventDefault(),o.select(n),g(n,r,e))},C=e=>{f&&e.pointerId===f.pointerId&&_(e)},w=e=>{f&&e.pointerId===f.pointerId&&b()},T=e=>{f&&e.pointerId===f.pointerId&&x()},E=e=>{if(f)return;let r=e.target.closest(`[data-egg-item]`);if(r){let i=t(e,r,c,s);(i!==m||r!==p)&&(p&&p!==r&&(p.style.cursor=``,p.removeAttribute(`data-egg-handle-hover`)),p===r&&m&&!i&&r.removeAttribute(`data-egg-handle-hover`),p=r,m=i,r.style.cursor=(i?n[i]:``)||``,i?r.setAttribute(`data-egg-handle-hover`,i):r.removeAttribute(`data-egg-handle-hover`))}else p&&(p.style.cursor=``,p.removeAttribute(`data-egg-handle-hover`),p=null,m=null)},D=e=>{e.key===`Escape`&&f&&x()};i.addEventListener(`pointerdown`,S,{capture:!0}),i.addEventListener(`pointermove`,E),document.addEventListener(`keydown`,D);function O(){i.removeEventListener(`pointerdown`,S,{capture:!0}),i.removeEventListener(`pointermove`,E),document.removeEventListener(`keydown`,D),f&&x()}return{destroy:O}}export{i as attachResize};
//# sourceMappingURL=resize.min.js.map